@model ERPNet.Application.Mailing.Models.ExcepcionEmailModel
@{
    Layout = "/_Layout.cshtml";
}

@section Estilos {
<style>
    .container { max-width: 700px; border-left: 5px solid #e74c3c; }
    h1 { color: #e74c3c; font-size: 20px; }
    table { width: 100%; border-collapse: collapse; margin: 16px 0; }
    th { text-align: left; padding: 8px 12px; background: #f8f8f8; border: 1px solid #ddd; width: 140px; color: #555; }
    td { padding: 8px 12px; border: 1px solid #ddd; word-break: break-all; }
    .stacktrace { background: #2d2d2d; color: #f8f8f2; padding: 16px; border-radius: 4px; font-family: Consolas, monospace; font-size: 12px; white-space: pre-wrap; overflow-x: auto; }
</style>
}

<h1>Excepcion en ERPNet</h1>

<table>
    <tr><th>CÃ³digo</th><td>@Model.Codigo</td></tr>
    <tr><th>Fecha</th><td>@Model.Fecha.ToString("yyyy-MM-dd HH:mm:ss") UTC</td></tr>
    <tr><th>Request</th><td>@Model.MetodoHttp @Model.Ruta@Model.QueryString</td></tr>
    <tr><th>Usuario</th><td>@(Model.UsuarioEmail ?? "No autenticado")</td></tr>
    <tr><th>IP</th><td>@(Model.DireccionIp ?? "Desconocida")</td></tr>
    <tr><th>Excepcion</th><td>@(Model.Origen ?? "Desconocido")</td></tr>
    <tr><th>Mensaje</th><td>@Model.Mensaje</td></tr>
</table>

@if (!string.IsNullOrEmpty(Model.StackTrace))
{
    <h3>Stack Trace</h3>
    <div class="stacktrace">@Model.StackTrace</div>
}

@if (!string.IsNullOrEmpty(Model.InnerExceptionMensaje))
{
    <h3>Inner Exception</h3>
    <table>
        <tr><th>Mensaje</th><td>@Model.InnerExceptionMensaje</td></tr>
    </table>
    if (!string.IsNullOrEmpty(Model.InnerExceptionStackTrace))
    {
        <div class="stacktrace">@Model.InnerExceptionStackTrace</div>
    }
}
